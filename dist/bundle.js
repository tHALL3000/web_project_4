!function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,console.log(t)}var r,o;return r=n,(o=[{key:"_showErrorMessage",value:function(e){var t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}},{key:"_hideErrorMessage",value:function(e){var t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)}},{key:"_checkInputValidity",value:function(e,t){e.validity.valid?this._hideErrorMessage(e,t):this._showErrorMessage(e,t)}},{key:"_toggleButtonState",value:function(e,t){this._inputs.every((function(e){return e.validity.valid}))?(this._button.classList.remove(this._inactiveButtonClass),this._button.disabled=!1):(this._button.classList.add(this._inactiveButtonClass),this._button.disabled=!0)}},{key:"_setEventListeners",value:function(){var t,n=this;this._inputs=function(t){if(Array.isArray(t))return e(t)}(t=this._form.querySelectorAll(this._inputSelector))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),this._button=this._form.querySelector(this._submitButtonSelector),this._inputs.forEach((function(e){e.addEventListener("input",(function(){n._checkInputValidity(e,n._button),n._toggleButtonState(n._inputs,n._button)}))}))}},{key:"enableValidation",value:function(){var e=this;this._form.addEventListener("submit",(function(t){t.preventDefault(),e._button.classList.add(e._inactiveButtonClass),e._button.disabled=!0})),this._setEventListeners()}}])&&t(r.prototype,o),n}();function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}document.querySelector(".modal__image"),document.querySelector(".modal__caption"),document.querySelector(".overlay_type_preview");var o=function(){function e(t,n){var r,o,i=this,a=t.data,c=t.handleCardClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=function(){i._heart.classList.toggle("photo-grid__heart_active")},(r="_handleLikeIcon")in this?Object.defineProperty(this,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[r]=o,this._text=a.name,this._link=a.link,this._cardSelector=n,this._handleCardClick=c}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".photo-grid__card").cloneNode(!0)}},{key:"_setEventListeners",value:function(){var e=this,t=this._card.querySelector(".photo-grid__heart"),n=this._card.querySelector(".photo-grid__delete"),r=this._card.querySelector(".photo-grid__picture");t.addEventListener("click",(function(){return e._handleLikeIcon()})),n.addEventListener("click",(function(){return e._handleDeleteIcon()})),r.addEventListener("click",(function(){return e._handleCardClick({link:e._link,name:e._name})}))}},{key:"_handleDeleteIcon",value:function(){this._card.remove()}},{key:"_prepareCard",value:function(){this._card.querySelector(".photo-grid__title").textContent=this._name,this._card.querySelector(".photo-grid__picture").src=this._link,this._card.alt="Image"+this._name,this._heart=this._card.querySelector(".photo-grid__heart")}},{key:"generateCard",value:function(){return this._card=this._getTemplate(),this._setEventListeners(),this._prepareCard(),this._card}}])&&r(t.prototype,n),e}();function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,"_handleEscKey",(function(e){e.preventDefault(),"Escape"===e.key&&n.close()})),a(this,"_handleOutsideClick",(function(e){n.close()})),this._popupElement=document.querySelector(t)}var t,n;return t=e,(n=[{key:"open",value:function(){var e=this;this._popupElement.classList.add("overlay_show"),this._popupElement.classList.contains("overlay_show")&&(document.addEventListener("keydown",(function(){e._handleEscKey()})),this._popupElement.addEventListener("click",(function(){e._handleOutsideClick()})))}},{key:"close",value:function(){this._popupElement.classList.remove("overlay_show"),document.removeEventListener("keydown",this._handleEscKey),modal.removeEventListener("click",this._handleOutsideClick)}},{key:"setEventListeners",value:function(){var e=this,t=document.querySelector(".modal__close-button");this._popupElement.classList.addEventListener("click",(function(n){(n.target.classList.contains("overlay_show")||n.target.classList.contains(t))&&e.close()}))}}])&&i(t.prototype,n),e}();function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,t))._submitForm=e,n._popupForm=n._popupElement.querySelector(".form-profile"),n}return t=a,(n=[{key:"_getInputValues",value:function(){profileName.textContent=nameInput.value,profileTitle.textContent=titleInput.value}},{key:"setEventListeners",value:function(){s(d(a.prototype),"setEventListeners",this).call(this),this._popupSelector.addEventListener("submit",(function(e){e.preventDefault(),toggleModal(overlay)}))}},{key:"close",value:function(){this._popupForm.reset(),s(d(a.prototype),"close",this).call(this)}}])&&u(t.prototype,n),a}(c);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(r);if(o){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return b(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e)}return t=a,(n=[{key:"open",value:function(e){var t=e.link,n=e.name;this._popupElement.querySelector(".modal__caption").textcontent=n;var r=this._popupElement.querySelector(".modal__image");r.src=t,r.alt="Magnificent artist interpretation of ".concat(n),v(w(a.prototype),"open",this).call(this)}}])&&m(t.prototype,n),a}(c);function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=o,this.items=r,this.cardContainer=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderSection",value:function(){var e=this;this.items.forEach((function(t){e.renderer(t)}))}},{key:"addItem",value:function(e){this.cardContainer.prepend(e)}}])&&E(t.prototype,n),e}(),k=document.querySelector("#editButton"),x=document.querySelector("#addPhoto"),C=document.querySelector(".modal_edit_profile").querySelector(".form-profile"),L=document.querySelector(".profile__name"),q=document.querySelector(".profile__job"),O=document.forms.profile.elements.name,j=document.forms.profile.elements.title,M=document.querySelector(".overlay_type_edit"),P=document.querySelector(".modal__close-button_add-photo"),D=document.querySelector(".modal__close-button_image"),B=(document.querySelector(".modal"),document.querySelector(".form_add")),H=function(e){e.classList.toggle("overlay_show"),e.classList.contains("overlay_show")?(document.addEventListener("keydown",handleEscKey),e.addEventListener("click",R)):(document.removeEventListener("keydown",handleEscKey),e.removeEventListener("click",R))},R=function(e){e.target.classList.contains("overlay")&&H(e.target)},A=document.querySelector(".overlay_type_edit"),I=document.querySelector(".overlay_type_add"),T=document.querySelector(".overlay_type_preview");k.addEventListener("click",(function(){O.value=L.textContent,j.value=q.textContent,H(A)})),x.addEventListener("click",(function(){H(I),document.getElementById("newPicture").reset()})),D.addEventListener("click",(function(){H(T)})),document.querySelector(".form-profile").addEventListener("submit",(function(e){e.preventDefault(),L.textContent=O.value,q.textContent=j.value,H(M)})),P.addEventListener("click",(function(){H(I)}));var V=document.querySelector(".form_add"),F=document.forms.newPicture.elements.nameOfPlace,N=document.forms.newPicture.elements.linkOfPlace,W=".card-template",K=function(e){var t=new o(e,W);X.prepend(t.generateCard())};V.addEventListener("submit",(function(e){e.preventDefault();var t={name:F.value,link:N.value};K(t),H(I)}));var X=document.querySelector(".photo-grid");[{name:"Silicon Valley",link:"https://images.unsplash.com/photo-1621646912321-c97a233701d2?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=716&q=80"},{name:"Miami Beach",link:"https://images.unsplash.com/photo-1622942817454-ed616e8d3a2d?ixid=MnwxMjA3fDB8MHx2aXN1YWwtc2VhcmNofDF8fHxlbnwwfHx8fA%3D%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=60"},{name:"Land of Fire & Ice",link:"https://images.unsplash.com/photo-1620053553156-92e15d54f7ee?ixid=MnwxMjA3fDB8MHxzZWFyY2h8OXx8eWVsbG93JTIwZmxhbWUlMjBibHVlJTIwc21va2V8ZW58MHx8MHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=60"},{name:"Neon Rain",link:"https://images.unsplash.com/photo-1621870616319-eeb7fdf31234?ixid=MnwxMjA3fDB8MHx2aXN1YWwtc2VhcmNofDF8fHxlbnwwfHx8fA%3D%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=60"},{name:"Fashion Capital",link:"https://images.unsplash.com/photo-1618245613901-e52b7e0123c7?ixid=MnwxMjA3fDB8MHxwcm9maWxlLXBhZ2V8MTl8fHxlbnwwfHx8fA%3D%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=60"},{name:"Cape Canaveral",link:"https://images.unsplash.com/photo-1530447920184-b88c8872?ixid=MnwxMjA3fDB8MHx2aXN1YWwtc2VhcmNofDF8fHxlbnwwfHx8fA%3D%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=60"}].forEach((function(e){K(e)}));var Y=new g(PopupSelector);Y.setEventListeners(),new S({renderer:function(e){console.log("renderer",e);var t=new o({data:e,handleCardClick:function(e){Y.open(e)}},W);X.prepend(t.generateCard())}}).setEventListeners(),new c(PopupSelector).setEventListeners(),new h(submitForm,PopupSelector).setEventListeners();var Z={inputSelector:".modal__form-control-input",submitButtonSelector:".button",inactiveButtonClass:"button_disabled",inputErrorClass:"modal__form-control-input-error",errorClass:"popup-error"},G=new n(Z,C),J=new n(Z,B);G.enableValidation(),J.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFhLElBQUlwQyxFQUFlWixlQUN0Q2dELEVBQVdDLG9CQUVLLElBQUlsQyxFQUFRLENBQzNCRyxTQUFVLFNBQUN2RCxHQUNWaEMsUUFBUUMsSUFDUCxXQUNBK0IsR0FFRCxJQUFNeUQsRUFDTCxJQUFJM0QsRUFDSCxDQUNDRSxLQUFBQSxFQUNBQyxnQkFBaUIsU0FDaEJELEdBRUFxRixFQUFXRSxLQUNWdkYsS0FJSEQsR0FFRm1GLEVBQVV4QixRQUNURCxFQUFLMEIsbUJBS0FHLG9CQUVNLElBQUkvRCxFQUFNYyxlQUNsQmlELG9CQUVZLElBQUluRCxFQUFjQyxXQUFZQyxlQUN0Q2lELG9CQUlWLElBQU1wSSxFQUFTLENBQ2RJLGNBQWUsNkJBQ2ZFLHFCQUFzQixVQUN0QkUsb0JBQXFCLGtCQUNyQkUsZ0JBQWlCLGtDQUNqQkUsV0FBWSxlQUdQMEgsRUFBb0IsSUFBSXZJLEVBQWNDLEVBQVEyRyxHQUM5QzRCLEVBQW9CLElBQUl4SSxFQUFjQyxFQUFRa0gsR0FFcERvQixFQUFrQkUsbUJBQ2xCRCxFQUFrQkMsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiogQGZvcm1hdCAqL1xuXG5jbGFzcyBGb3JtVmFsaWRhdG9yIHtcblx0Y29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xuXHRcdHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3Rvcjtcblx0XHR0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcjtcblx0XHR0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG5cdFx0dGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcblx0XHR0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XG5cdFx0dGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xuXHRcdGNvbnNvbGUubG9nKGZvcm1FbGVtZW50KTtcblx0fVxuXG5cdF9zaG93RXJyb3JNZXNzYWdlKGlucHV0KSB7XG5cdFx0Y29uc3QgZXJyb3IgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xuXHRcdGVycm9yLnRleHRDb250ZW50ID0gaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2U7XG5cdFx0ZXJyb3IuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcblx0XHRpbnB1dC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG5cdH1cblx0X2hpZGVFcnJvck1lc3NhZ2UoaW5wdXQpIHtcblx0XHRjb25zdCBlcnJvciA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XG5cdFx0ZXJyb3IudGV4dENvbnRlbnQgPSBcIlwiO1xuXHRcdGVycm9yLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG5cdFx0aW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuXHR9XG5cblx0X2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCwgYnV0dG9uKSB7XG5cdFx0aWYgKGlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG5cdFx0XHR0aGlzLl9oaWRlRXJyb3JNZXNzYWdlKGlucHV0LCBidXR0b24pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9zaG93RXJyb3JNZXNzYWdlKGlucHV0LCBidXR0b24pO1xuXHRcdH1cblx0fVxuXG5cdF90b2dnbGVCdXR0b25TdGF0ZShpbnB1dHMsIGJ1dHRvbikge1xuXHRcdGNvbnN0IGlzVmFsaWQgPSB0aGlzLl9pbnB1dHMuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XG5cdFx0aWYgKGlzVmFsaWQpIHtcblx0XHRcdHRoaXMuX2J1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuXHRcdFx0dGhpcy5fYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuX2J1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuXHRcdFx0dGhpcy5fYnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcblx0XHR9XG5cdH1cblxuXHRfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG5cdFx0dGhpcy5faW5wdXRzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG5cdFx0dGhpcy5fYnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblx0XHR0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcblx0XHRcdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG5cdFx0XHRcdC8vQ2hlY2sgaW5wdXQgdmFsaWRpdHlcblx0XHRcdFx0dGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0LCB0aGlzLl9idXR0b24pO1xuXHRcdFx0XHQvL3RvZ2dsZSBidXR0b24gc3RhdGVcblx0XHRcdFx0dGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRzLCB0aGlzLl9idXR0b24pO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRlbmFibGVWYWxpZGF0aW9uKCkge1xuXHRcdHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0dGhpcy5fYnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG5cdFx0XHR0aGlzLl9idXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblx0fVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xuIiwiLyoqIEBmb3JtYXQgKi9cblxuLy8qKiBAZm9ybWF0ICovXG5cbmNvbnN0IGltYWdlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuY29uc3QgaW1hZ2VDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcblxuY29uc3QgbW9kYWxQcmV2aWV3V2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vdmVybGF5X3R5cGVfcHJldmlld1wiKTtcblxuY29uc3QgdG9nZ2xlTW9kYWwgPSAobW9kYWwpID0+IHtcblx0bW9kYWwuY2xhc3NMaXN0LnRvZ2dsZShcIm92ZXJsYXlfc2hvd1wiKTtcblx0aWYgKFxuXHRcdG1vZGFsLmNsYXNzTGlzdC5jb250YWlucyhcblx0XHRcdFwib3ZlcmxheV9zaG93XCJcblx0XHQpXG5cdCkge1xuXHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG5cdFx0XHRcImtleWRvd25cIixcblx0XHRcdGhhbmRsZUVzY0tleVxuXHRcdCk7XG5cdFx0bW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcblx0XHRcdFwiY2xpY2tcIixcblx0XHRcdGhhbmRsZU91dHNpZGVDbGlja1xuXHRcdCk7XG5cdH0gZWxzZSB7XG5cdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcblx0XHRcdFwia2V5ZG93blwiLFxuXHRcdFx0aGFuZGxlRXNjS2V5XG5cdFx0KTtcblx0XHRtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFxuXHRcdFx0XCJjbGlja1wiLFxuXHRcdFx0aGFuZGxlT3V0c2lkZUNsaWNrXG5cdFx0KTtcblx0fVxufTtcblxuLy8gY29uc3QgaGFuZGxlRXNjS2V5ID0gKGUpID0+IHtcbi8vIFx0Y29uc3QgYWN0aXZlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlfc2hvd1wiKTtcbi8vIFx0aWYgKGUua2V5ID09PSBcIkVzY2FwZVwiICYmIGFjdGl2ZU1vZGFsKSB7XG4vLyBcdFx0dG9nZ2xlTW9kYWwoYWN0aXZlTW9kYWwpO1xuLy8gXHR9XG4vLyB9O1xuXG5jb25zdCBoYW5kbGVPdXRzaWRlQ2xpY2sgPSAoZSkgPT4ge1xuXHRpZiAoXG5cdFx0ZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFxuXHRcdFx0XCJvdmVybGF5XCJcblx0XHQpXG5cdCkge1xuXHRcdHRvZ2dsZU1vZGFsKFxuXHRcdFx0ZS50YXJnZXRcblx0XHQpO1xuXHR9XG59O1xuXG5jbGFzcyBDYXJkIHtcblx0Y29uc3RydWN0b3IoXG5cdFx0e1xuXHRcdFx0ZGF0YSxcblx0XHRcdGhhbmRsZUNhcmRDbGljayxcblx0XHR9LFxuXHRcdGNhcmRTZWxlY3RvclxuXHQpIHtcblx0XHR0aGlzLl90ZXh0ID1cblx0XHRcdGRhdGEubmFtZTtcblx0XHR0aGlzLl9saW5rID1cblx0XHRcdGRhdGEubGluaztcblx0XHR0aGlzLl9jYXJkU2VsZWN0b3IgPVxuXHRcdFx0Y2FyZFNlbGVjdG9yO1xuXHRcdHRoaXMuX2hhbmRsZUNhcmRDbGljayA9XG5cdFx0XHRoYW5kbGVDYXJkQ2xpY2s7XG5cdH1cblxuXHRfZ2V0VGVtcGxhdGUoKSB7XG5cdFx0Y29uc3QgY2FyZEVsZW1lbnQgPVxuXHRcdFx0ZG9jdW1lbnRcblx0XHRcdFx0LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcdFx0dGhpc1xuXHRcdFx0XHRcdFx0Ll9jYXJkU2VsZWN0b3Jcblx0XHRcdFx0KVxuXHRcdFx0XHQuY29udGVudC5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0XHRcdFwiLnBob3RvLWdyaWRfX2NhcmRcIlxuXHRcdFx0XHQpXG5cdFx0XHRcdC5jbG9uZU5vZGUoXG5cdFx0XHRcdFx0dHJ1ZVxuXHRcdFx0XHQpO1xuXG5cdFx0cmV0dXJuIGNhcmRFbGVtZW50O1xuXHR9XG5cblx0X3NldEV2ZW50TGlzdGVuZXJzKCkge1xuXHRcdGNvbnN0IGNhcmRMaWtlID1cblx0XHRcdHRoaXMuX2NhcmQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIucGhvdG8tZ3JpZF9faGVhcnRcIlxuXHRcdFx0KTtcblx0XHRjb25zdCBjYXJkRGVsZXRlID1cblx0XHRcdHRoaXMuX2NhcmQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIucGhvdG8tZ3JpZF9fZGVsZXRlXCJcblx0XHRcdCk7XG5cdFx0Y29uc3QgY2FyZEltYWdlID1cblx0XHRcdHRoaXMuX2NhcmQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIucGhvdG8tZ3JpZF9fcGljdHVyZVwiXG5cdFx0XHQpO1xuXG5cdFx0Y2FyZExpa2UuYWRkRXZlbnRMaXN0ZW5lcihcblx0XHRcdFwiY2xpY2tcIixcblx0XHRcdCgpID0+XG5cdFx0XHRcdHRoaXMuX2hhbmRsZUxpa2VJY29uKClcblx0XHQpO1xuXHRcdGNhcmREZWxldGUuYWRkRXZlbnRMaXN0ZW5lcihcblx0XHRcdFwiY2xpY2tcIixcblx0XHRcdCgpID0+XG5cdFx0XHRcdHRoaXMuX2hhbmRsZURlbGV0ZUljb24oKVxuXHRcdCk7XG5cdFx0Y2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXG5cdFx0XHRcImNsaWNrXCIsXG5cdFx0XHQoKSA9PlxuXHRcdFx0XHR0aGlzLl9oYW5kbGVDYXJkQ2xpY2soXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0bGluazogdGhpc1xuXHRcdFx0XHRcdFx0XHQuX2xpbmssXG5cdFx0XHRcdFx0XHRuYW1lOiB0aGlzXG5cdFx0XHRcdFx0XHRcdC5fbmFtZSxcblx0XHRcdFx0XHR9XG5cdFx0XHRcdClcblx0XHQpO1xuXHR9XG5cblx0Ly8gX2hhbmRsZVByZXZpZXdQaWN0dXJlKCkge1xuXHQvLyBcdGltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xuXHQvLyBcdGltYWdlRWxlbWVudC5hbHQgPSBcIkltYWdlXCIgKyB0aGlzLl9uYW1lICsgXCJcIjtcblx0Ly8gXHRpbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXHQvLyBcdHRvZ2dsZU1vZGFsKG1vZGFsUHJldmlld1dpbmRvdyk7XG5cdC8vIH1cblxuXHRfaGFuZGxlTGlrZUljb24gPSAoKSA9PiB7XG5cdFx0dGhpcy5faGVhcnQuY2xhc3NMaXN0LnRvZ2dsZShcblx0XHRcdFwicGhvdG8tZ3JpZF9faGVhcnRfYWN0aXZlXCJcblx0XHQpO1xuXHR9O1xuXG5cdF9oYW5kbGVEZWxldGVJY29uKCkge1xuXHRcdHRoaXMuX2NhcmQucmVtb3ZlKCk7XG5cdH1cblxuXHRfcHJlcGFyZUNhcmQoKSB7XG5cdFx0dGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0XCIucGhvdG8tZ3JpZF9fdGl0bGVcIlxuXHRcdCkudGV4dENvbnRlbnQgPVxuXHRcdFx0dGhpcy5fbmFtZTtcblx0XHR0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcIi5waG90by1ncmlkX19waWN0dXJlXCJcblx0XHQpLnNyYyA9XG5cdFx0XHR0aGlzLl9saW5rO1xuXHRcdHRoaXMuX2NhcmQuYWx0ID1cblx0XHRcdFwiSW1hZ2VcIiArXG5cdFx0XHR0aGlzXG5cdFx0XHRcdC5fbmFtZSArXG5cdFx0XHRcIlwiO1xuXHRcdHRoaXMuX2hlYXJ0ID1cblx0XHRcdHRoaXMuX2NhcmQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIucGhvdG8tZ3JpZF9faGVhcnRcIlxuXHRcdFx0KTtcblx0fVxuXG5cdGdlbmVyYXRlQ2FyZCgpIHtcblx0XHR0aGlzLl9jYXJkID1cblx0XHRcdHRoaXMuX2dldFRlbXBsYXRlKCk7XG5cdFx0dGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblx0XHR0aGlzLl9wcmVwYXJlQ2FyZCgpO1xuXG5cdFx0cmV0dXJuIHRoaXNcblx0XHRcdC5fY2FyZDtcblx0fVxufVxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcbiIsIi8qKiBAZm9ybWF0ICovXG5cbi8vKiogQGZvcm1hdCAqL1xuXG5jbGFzcyBQb3B1cCB7XG5cdGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcblx0XHR0aGlzLl9wb3B1cEVsZW1lbnQgPVxuXHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0cG9wdXBTZWxlY3RvclxuXHRcdFx0KTtcblx0fVxuXHRfaGFuZGxlRXNjS2V5ID0gKGUpID0+IHtcblx0XHQvLyBjb25zdCBhY3RpdmVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheV9zaG93XCIpO1xuXHRcdC8vIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIiAmJiBhY3RpdmVNb2RhbCkge1xuXHRcdC8vICAgICB0b2dnbGVNb2RhbChhY3RpdmVNb2RhbCk7IC8vY2xvc2UgZnVuY3Rpb25cblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0aWYgKFxuXHRcdFx0ZS5rZXkgPT09XG5cdFx0XHRcIkVzY2FwZVwiXG5cdFx0KVxuXHRcdFx0dGhpcy5jbG9zZSgpO1xuXHR9O1xuXG5cdF9oYW5kbGVPdXRzaWRlQ2xpY2sgPSAoZSkgPT4ge1xuXHRcdC8vIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJvdmVybGF5XCIpKVxuXHRcdC8vICAgICB0b2dnbGVNb2RhbChlLnRhcmdldCk7IC8vY2xvc2UgZnVuY3Rpb25cblx0XHR0aGlzLmNsb3NlKCk7XG5cdH07XG5cdG9wZW4oKSB7XG5cdFx0dGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXG5cdFx0XHRcIm92ZXJsYXlfc2hvd1wiXG5cdFx0KTtcblx0XHRpZiAoXG5cdFx0XHR0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFxuXHRcdFx0XHRcIm92ZXJsYXlfc2hvd1wiXG5cdFx0XHQpXG5cdFx0KSB7XG5cdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFxuXHRcdFx0XHRcImtleWRvd25cIixcblx0XHRcdFx0KCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuX2hhbmRsZUVzY0tleSgpO1xuXHRcdFx0XHR9XG5cdFx0XHQpO1xuXHRcdFx0dGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG5cdFx0XHRcdFwiY2xpY2tcIixcblx0XHRcdFx0KCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuX2hhbmRsZU91dHNpZGVDbGljaygpO1xuXHRcdFx0XHR9XG5cdFx0XHQpO1xuXHRcdH1cblx0fVxuXG5cdGNsb3NlKCkge1xuXHRcdHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFxuXHRcdFx0XCJvdmVybGF5X3Nob3dcIlxuXHRcdCk7XG5cdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcblx0XHRcdFwia2V5ZG93blwiLFxuXHRcdFx0dGhpc1xuXHRcdFx0XHQuX2hhbmRsZUVzY0tleVxuXHRcdCk7XG5cdFx0bW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcblx0XHRcdFwiY2xpY2tcIixcblx0XHRcdHRoaXNcblx0XHRcdFx0Ll9oYW5kbGVPdXRzaWRlQ2xpY2tcblx0XHQpO1xuXHR9XG5cblx0c2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG5cdFx0Y29uc3QgcHJvZmlsZUNsb3NlID1cblx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcdFwiLm1vZGFsX19jbG9zZS1idXR0b25cIlxuXHRcdFx0KTtcblx0XHR0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZEV2ZW50TGlzdGVuZXIoXG5cdFx0XHRcImNsaWNrXCIsXG5cdFx0XHQoXG5cdFx0XHRcdGVcblx0XHRcdCkgPT4ge1xuXHRcdFx0XHRpZiAoXG5cdFx0XHRcdFx0ZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFxuXHRcdFx0XHRcdFx0XCJvdmVybGF5X3Nob3dcIlxuXHRcdFx0XHRcdCkgfHxcblx0XHRcdFx0XHRlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXG5cdFx0XHRcdFx0XHRwcm9maWxlQ2xvc2Vcblx0XHRcdFx0XHQpXG5cdFx0XHRcdCkge1xuXHRcdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdCk7XG5cdH1cbn1cbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xuIiwiLyoqIEBmb3JtYXQgKi9cblxuLy8qKiBAZm9ybWF0ICovXG5cbmltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuXHRjb25zdHJ1Y3RvcihzdWJtaXRGb3JtLCBQb3B1cFNlbGVjdG9yKSB7XG5cdFx0c3VwZXIoXG5cdFx0XHRQb3B1cFNlbGVjdG9yXG5cdFx0KTtcblx0XHR0aGlzLl9zdWJtaXRGb3JtID1cblx0XHRcdHN1Ym1pdEZvcm07XG5cdFx0dGhpcy5fcG9wdXBGb3JtID1cblx0XHRcdHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0XHRcIi5mb3JtLXByb2ZpbGVcIlxuXHRcdFx0KTtcblx0fVxuXG5cdF9nZXRJbnB1dFZhbHVlcygpIHtcblx0XHRwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9XG5cdFx0XHRuYW1lSW5wdXQudmFsdWU7XG5cdFx0cHJvZmlsZVRpdGxlLnRleHRDb250ZW50ID1cblx0XHRcdHRpdGxlSW5wdXQudmFsdWU7XG5cdFx0Ly9pbnB1dCB2YWx1ZXMgZnJvbSBmb3JtIGZpZWxkc1xuXHRcdC8vXCJuYW1lXCI6IG5ld0l0ZW1OYW1lLnZhbHVlLFxuXHRcdC8vXCJsaW5rXCI6IG5ld0l0ZW1MaW5rLnZhbHVlXG5cdH1cblxuXHRzZXRFdmVudExpc3RlbmVycygpIHtcblx0XHRzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuXHRcdHRoaXMuX3BvcHVwU2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcihcblx0XHRcdFwic3VibWl0XCIsXG5cdFx0XHQoXG5cdFx0XHRcdGVcblx0XHRcdCkgPT4ge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHRvZ2dsZU1vZGFsKFxuXHRcdFx0XHRcdG92ZXJsYXlcblx0XHRcdFx0KTtcblx0XHRcdFx0Ly9hZGQgY2xpY2sgZXZlbnQgbGlzdGVuZXJjbG9zZSBpY29uXG5cdFx0XHRcdC8vYWRkIHN1Ym1pdCB0byBzdWJtaXQgYnV0dG9uXG5cdFx0XHR9XG5cdFx0KTtcblx0fVxuXG5cdGNsb3NlKCkge1xuXHRcdHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuXHRcdHN1cGVyLmNsb3NlKCk7XG5cdFx0Ly9yZXNldFxuXHR9XG59XG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xuIiwiLyoqIEBmb3JtYXQgKi9cblxuLy8qKiBAZm9ybWF0ICovXG5cbmltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcblx0Y29uc3RydWN0b3IoUG9wdXBTZWxlY3Rvcikge1xuXHRcdHN1cGVyKFBvcHVwU2VsZWN0b3IpO1xuXHR9XG5cblx0b3Blbih7IGxpbmssIG5hbWUgfSkge1xuXHRcdC8vZ2V0IG5hbWUgYW5kIGxpbmsgZnJvbSBtb2RlbCBmb3JtXG5cdFx0dGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIikudGV4dGNvbnRlbnQgPSBuYW1lO1xuXHRcdGNvbnN0IGltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuXHRcdGltYWdlLnNyYyA9IGxpbms7XG5cdFx0aW1hZ2UuYWx0ID0gYE1hZ25pZmljZW50IGFydGlzdCBpbnRlcnByZXRhdGlvbiBvZiAke25hbWV9YDtcblx0XHQvL2NhbGwgb3BlbiBmdW5jdGlvbiBmcm9tIHBhcmVudCBjbGFzcyB3aXRoIHN1cGVyXG5cdFx0c3VwZXIub3BlbigpO1xuXHR9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEltYWdlO1xuIiwiLyoqIEBmb3JtYXQgKi9cblxuLy8qKiBAZm9ybWF0ICovXG5cbmNsYXNzIFNlY3Rpb24ge1xuXHRjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjYXJkQ29udGFpbmVyKSB7XG5cdFx0dGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuXHRcdHRoaXMuaXRlbXMgPSBpdGVtcztcblx0XHR0aGlzLmNhcmRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNhcmRDb250YWluZXIpO1xuXHR9XG5cblx0cmVuZGVyU2VjdGlvbigpIHtcblx0XHQvL3JlbmRlciBlYWNoIGVsZW1lbnQgb24gcGFnZVxuXHRcdHRoaXMuaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuXHRcdFx0dGhpcy5yZW5kZXJlcihpdGVtKTtcblx0XHR9KTtcblx0fVxuXG5cdGFkZEl0ZW0oY2FyZCkge1xuXHRcdC8vdGFrZXMgRE9NIGVsZW1lbnQgYW5kIGFkZHMgaXQgdG8gdGhlIGNvbnRhaW5lclxuXHRcdHRoaXMuY2FyZENvbnRhaW5lci5wcmVwZW5kKGNhcmQpO1xuXHR9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247XG4iLCIvKiogQGZvcm1hdCAqL1xuXG4vLyoqIEBmb3JtYXQgKi9cbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi91dGlscy9Gb3JtVmFsaWRhdG9yXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbi8vaW1wb3J0IFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIjtcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi91dGlscy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xuXG5jb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0QnV0dG9uXCIpO1xuY29uc3QgcGhvdG9Nb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkUGhvdG9cIik7XG5jb25zdCBtb2RhbFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX2VkaXRfcHJvZmlsZVwiKTtcbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IG1vZGFsUHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLmZvcm0tcHJvZmlsZVwiKTtcblxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2pvYlwiKTtcblxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQuZm9ybXMucHJvZmlsZS5lbGVtZW50cy5uYW1lO1xuY29uc3QgdGl0bGVJbnB1dCA9IGRvY3VtZW50LmZvcm1zLnByb2ZpbGUuZWxlbWVudHMudGl0bGU7XG5cbmNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlfdHlwZV9lZGl0XCIpO1xuXG4vLyBjb25zdCBwcm9maWxlQ2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIik7XG5jb25zdCBhZGRQaG90b0Nsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uX2FkZC1waG90b1wiKTtcbmNvbnN0IGltZ1ByZXZpZXdDbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvbl9pbWFnZVwiKTtcblxuY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsXCIpO1xuY29uc3QgY2FyZEZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX2FkZFwiKTtcblxuY29uc3QgdG9nZ2xlTW9kYWwgPSAobW9kYWwpID0+IHtcblx0bW9kYWwuY2xhc3NMaXN0LnRvZ2dsZShcIm92ZXJsYXlfc2hvd1wiKTtcblx0aWYgKFxuXHRcdG1vZGFsLmNsYXNzTGlzdC5jb250YWlucyhcblx0XHRcdFwib3ZlcmxheV9zaG93XCJcblx0XHQpXG5cdCkge1xuXHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG5cdFx0XHRcImtleWRvd25cIixcblx0XHRcdGhhbmRsZUVzY0tleVxuXHRcdCk7XG5cdFx0bW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcblx0XHRcdFwiY2xpY2tcIixcblx0XHRcdGhhbmRsZU91dHNpZGVDbGlja1xuXHRcdCk7XG5cdH0gZWxzZSB7XG5cdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcblx0XHRcdFwia2V5ZG93blwiLFxuXHRcdFx0aGFuZGxlRXNjS2V5XG5cdFx0KTtcblx0XHRtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFxuXHRcdFx0XCJjbGlja1wiLFxuXHRcdFx0aGFuZGxlT3V0c2lkZUNsaWNrXG5cdFx0KTtcblx0fVxufTtcblxuY29uc3QgaGFuZGxlT3V0c2lkZUNsaWNrID0gKGUpID0+IHtcblx0aWYgKFxuXHRcdGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcblx0XHRcdFwib3ZlcmxheVwiXG5cdFx0KVxuXHQpIHtcblx0XHR0b2dnbGVNb2RhbChcblx0XHRcdGUudGFyZ2V0XG5cdFx0KTtcblx0fVxufTtcbi8vY29uc3QgaGFuZGxlRXNjS2V5ID0gKGUpID0+IHtcbi8vIFx0Y29uc3QgYWN0aXZlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlfc2hvd1wiKTtcbi8vIFx0aWYgKGUua2V5ID09PSBcIkVzY2FwZVwiICYmIGFjdGl2ZU1vZGFsKSB7XG4vLyBcdFx0dG9nZ2xlTW9kYWwoYWN0aXZlTW9kYWwpO1xuLy8gXHR9XG4vLyB9O1xuXG5jb25zdCBtb2RhbEVkaXRXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlfdHlwZV9lZGl0XCIpO1xuY29uc3QgbW9kYWxBZGRXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlfdHlwZV9hZGRcIik7XG5jb25zdCBtb2RhbFByZXZpZXdXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlfdHlwZV9wcmV2aWV3XCIpO1xuXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdG5hbWVJbnB1dC52YWx1ZSA9XG5cdFx0cHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XG5cdHRpdGxlSW5wdXQudmFsdWUgPVxuXHRcdHByb2ZpbGVUaXRsZS50ZXh0Q29udGVudDtcblx0dG9nZ2xlTW9kYWwobW9kYWxFZGl0V2luZG93KTtcbn0pO1xuXG5waG90b01vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdHRvZ2dsZU1vZGFsKG1vZGFsQWRkV2luZG93KTtcblx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG5cdFx0XCJuZXdQaWN0dXJlXCJcblx0KS5yZXNldCgpO1xufSk7XG5cbi8vIHByb2ZpbGVDbG9zZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuLy8gXHR0b2dnbGVNb2RhbChtb2RhbEVkaXRXaW5kb3cpO1xuLy8gfSk7XG5cbmltZ1ByZXZpZXdDbG9zZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXHR0b2dnbGVNb2RhbChtb2RhbFByZXZpZXdXaW5kb3cpO1xufSk7XG5cbmNvbnN0IGZvcm1Qcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtLXByb2ZpbGVcIik7XG5mb3JtUHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG5cdGUucHJldmVudERlZmF1bHQoKTtcblx0cHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPVxuXHRcdG5hbWVJbnB1dC52YWx1ZTtcblx0cHJvZmlsZVRpdGxlLnRleHRDb250ZW50ID1cblx0XHR0aXRsZUlucHV0LnZhbHVlO1xuXHR0b2dnbGVNb2RhbChvdmVybGF5KTtcbn0pO1xuXG5hZGRQaG90b0Nsb3NlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdHRvZ2dsZU1vZGFsKG1vZGFsQWRkV2luZG93KTtcbn0pO1xuXG5jb25zdCBhZGRQaWN0dXJlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9hZGRcIik7XG5jb25zdCBwaWN0dXJlVGl0bGVJbnB1dCA9IGRvY3VtZW50LmZvcm1zLm5ld1BpY3R1cmUuZWxlbWVudHMubmFtZU9mUGxhY2U7XG5jb25zdCBwaWN0dXJlTGlua0lucHV0ID0gZG9jdW1lbnQuZm9ybXMubmV3UGljdHVyZS5lbGVtZW50cy5saW5rT2ZQbGFjZTtcbmNvbnN0IGNhcmRTZWxlY3RvciA9IFwiLmNhcmQtdGVtcGxhdGVcIjtcblxuY29uc3QgcmVuZGVyQ2FyZCA9IChkYXRhKSA9PiB7XG5cdGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcblx0XHRkYXRhLFxuXHRcdGNhcmRTZWxlY3RvclxuXHQpO1xuXHRwaG90b0dyaWQucHJlcGVuZChjYXJkLmdlbmVyYXRlQ2FyZCgpKTtcbn07XG5cbmFkZFBpY3R1cmVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcblx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRjb25zdCB1c2VyQ2FyZCA9IHtcblx0XHRuYW1lOiBwaWN0dXJlVGl0bGVJbnB1dC52YWx1ZSxcblx0XHRsaW5rOiBwaWN0dXJlTGlua0lucHV0LnZhbHVlLFxuXHR9O1xuXG5cdHJlbmRlckNhcmQodXNlckNhcmQpO1xuXHR0b2dnbGVNb2RhbChtb2RhbEFkZFdpbmRvdyk7XG59KTtcblxuY29uc3QgaW5pdGlhbENhcmRzID0gW1xuXHR7XG5cdFx0bmFtZTogXCJTaWxpY29uIFZhbGxleVwiLFxuXHRcdGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE2MjE2NDY5MTIzMjEtYzk3YTIzMzcwMWQyP2l4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmaXhsaWI9cmItMS4yLjEmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz03MTYmcT04MFwiLFxuXHR9LFxuXHR7XG5cdFx0bmFtZTogXCJNaWFtaSBCZWFjaFwiLFxuXHRcdGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE2MjI5NDI4MTc0NTQtZWQ2MTZlOGQzYTJkP2l4aWQ9TW53eE1qQTNmREI4TUh4MmFYTjFZV3d0YzJWaGNtTm9mREY4Zkh4bGJud3dmSHg4ZkElM0QlM0QmaXhsaWI9cmItMS4yLjEmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz04MDAmcT02MFwiLFxuXHR9LFxuXHR7XG5cdFx0bmFtZTogXCJMYW5kIG9mIEZpcmUgJiBJY2VcIixcblx0XHRsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjIwMDUzNTUzMTU2LTkyZTE1ZDU0ZjdlZT9peGlkPU1ud3hNakEzZkRCOE1IeHpaV0Z5WTJoOE9YeDhlV1ZzYkc5M0pUSXdabXhoYldVbE1qQmliSFZsSlRJd2MyMXZhMlY4Wlc1OE1IeDhNSHg4Jml4bGliPXJiLTEuMi4xJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9ODAwJnE9NjBcIixcblx0fSxcblx0e1xuXHRcdG5hbWU6IFwiTmVvbiBSYWluXCIsXG5cdFx0bGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTYyMTg3MDYxNjMxOS1lZWI3ZmRmMzEyMzQ/aXhpZD1Nbnd4TWpBM2ZEQjhNSHgyYVhOMVlXd3RjMlZoY21Ob2ZERjhmSHhsYm53d2ZIeDhmQSUzRCUzRCZpeGxpYj1yYi0xLjIuMSZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTgwMCZxPTYwXCIsXG5cdH0sXG5cdHtcblx0XHRuYW1lOiBcIkZhc2hpb24gQ2FwaXRhbFwiLFxuXHRcdGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE2MTgyNDU2MTM5MDEtZTUyYjdlMDEyM2M3P2l4aWQ9TW53eE1qQTNmREI4TUh4d2NtOW1hV3hsTFhCaFoyVjhNVGw4Zkh4bGJud3dmSHg4ZkElM0QlM0QmaXhsaWI9cmItMS4yLjEmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz04MDAmcT02MFwiLFxuXHR9LFxuXHR7XG5cdFx0bmFtZTogXCJDYXBlIENhbmF2ZXJhbFwiLFxuXHRcdGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1MzA0NDc5MjAxODQtYjg4Yzg4NzI/aXhpZD1Nbnd4TWpBM2ZEQjhNSHgyYVhOMVlXd3RjMlZoY21Ob2ZERjhmSHhsYm53d2ZIeDhmQSUzRCUzRCZpeGxpYj1yYi0xLjIuMSZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTgwMCZxPTYwXCIsXG5cdH0sXG5dO1xuXG5jb25zdCBwaG90b0dyaWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3RvLWdyaWRcIik7XG5cbmluaXRpYWxDYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG5cdHJlbmRlckNhcmQoY2FyZCk7XG59KTtcblxuLy8gY29uc3QgdXNlckluZm8gPSBuZXcgdXNlckluZm8oe1xuLy8gXHR1c2VybmFtZVNlbGVjdG9yOiBwcm9maWxlQ29uZmlnLnByb2ZpbGVUaXRsZSxcbi8vIFx0dXNlckRlc2NyaXB0aW9uU2VsZWN0b3I6IHByb2ZpbGVDb25maWcucHJvZmlsZURlc2NyaXB0aW9uXG4vLyB9KVxuXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFBvcHVwU2VsZWN0b3IpO1xuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xuXHRyZW5kZXJlcjogKGRhdGEpID0+IHtcblx0XHRjb25zb2xlLmxvZyhcblx0XHRcdFwicmVuZGVyZXJcIixcblx0XHRcdGRhdGFcblx0XHQpO1xuXHRcdGNvbnN0IGNhcmQgPVxuXHRcdFx0bmV3IENhcmQoXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRkYXRhLFxuXHRcdFx0XHRcdGhhbmRsZUNhcmRDbGljazogKFxuXHRcdFx0XHRcdFx0ZGF0YVxuXHRcdFx0XHRcdCkgPT4ge1xuXHRcdFx0XHRcdFx0aW1hZ2VQb3B1cC5vcGVuKFxuXHRcdFx0XHRcdFx0XHRkYXRhXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGNhcmRTZWxlY3RvclxuXHRcdFx0KTtcblx0XHRwaG90b0dyaWQucHJlcGVuZChcblx0XHRcdGNhcmQuZ2VuZXJhdGVDYXJkKClcblx0XHQpO1xuXHRcdChcIi5jYXJkLXRlbXBsYXRlXCIpO1xuXHR9LFxufSk7XG5zZWN0aW9uLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwID0gbmV3IFBvcHVwKFBvcHVwU2VsZWN0b3IpO1xucG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcG9wdXBGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oc3VibWl0Rm9ybSwgUG9wdXBTZWxlY3Rvcik7XG5wb3B1cEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8obmFtZVNlbGVjdG9yLCB0aXRsZVNlbGVjdG9yKTtcblxuY29uc3QgY29uZmlnID0ge1xuXHRpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybS1jb250cm9sLWlucHV0XCIsXG5cdHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5idXR0b25cIixcblx0aW5hY3RpdmVCdXR0b25DbGFzczogXCJidXR0b25fZGlzYWJsZWRcIixcblx0aW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19mb3JtLWNvbnRyb2wtaW5wdXQtZXJyb3JcIixcblx0ZXJyb3JDbGFzczogXCJwb3B1cC1lcnJvclwiLFxufTtcblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGVkaXRGb3JtRWxlbWVudCk7XG5jb25zdCBjYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgY2FyZEZvcm1FbGVtZW50KTtcblxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuY2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuIl0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsImNvbnNvbGUiLCJsb2ciLCJpbnB1dCIsImVycm9yIiwicXVlcnlTZWxlY3RvciIsImlkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImJ1dHRvbiIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUVycm9yTWVzc2FnZSIsIl9zaG93RXJyb3JNZXNzYWdlIiwiaW5wdXRzIiwiX2lucHV0cyIsImV2ZXJ5IiwiX2J1dHRvbiIsImRpc2FibGVkIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIl9zZXRFdmVudExpc3RlbmVycyIsImRvY3VtZW50IiwiQ2FyZCIsImNhcmRTZWxlY3RvciIsImRhdGEiLCJoYW5kbGVDYXJkQ2xpY2siLCJfaGVhcnQiLCJ0b2dnbGUiLCJfdGV4dCIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTGlrZSIsIl9jYXJkIiwiY2FyZERlbGV0ZSIsImNhcmRJbWFnZSIsIl9oYW5kbGVMaWtlSWNvbiIsIl9oYW5kbGVEZWxldGVJY29uIiwiX25hbWUiLCJzcmMiLCJhbHQiLCJfZ2V0VGVtcGxhdGUiLCJfcHJlcGFyZUNhcmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJrZXkiLCJjbG9zZSIsIl9wb3B1cEVsZW1lbnQiLCJjb250YWlucyIsIl9oYW5kbGVFc2NLZXkiLCJfaGFuZGxlT3V0c2lkZUNsaWNrIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm1vZGFsIiwicHJvZmlsZUNsb3NlIiwidGFyZ2V0IiwiUG9wdXBXaXRoRm9ybSIsInN1Ym1pdEZvcm0iLCJQb3B1cFNlbGVjdG9yIiwiX3N1Ym1pdEZvcm0iLCJfcG9wdXBGb3JtIiwicHJvZmlsZU5hbWUiLCJuYW1lSW5wdXQiLCJ2YWx1ZSIsInByb2ZpbGVUaXRsZSIsInRpdGxlSW5wdXQiLCJfcG9wdXBTZWxlY3RvciIsInRvZ2dsZU1vZGFsIiwib3ZlcmxheSIsInJlc2V0IiwiUG9wdXBXaXRoSW1hZ2UiLCJ0ZXh0Y29udGVudCIsImltYWdlIiwiU2VjdGlvbiIsImNhcmRDb250YWluZXIiLCJpdGVtcyIsInJlbmRlcmVyIiwiaXRlbSIsImNhcmQiLCJwcmVwZW5kIiwiZWRpdEJ1dHRvbiIsInBob3RvTW9kYWxCdXR0b24iLCJlZGl0Rm9ybUVsZW1lbnQiLCJmb3JtcyIsInByb2ZpbGUiLCJlbGVtZW50cyIsInRpdGxlIiwiYWRkUGhvdG9DbG9zZSIsImltZ1ByZXZpZXdDbG9zZSIsImNhcmRGb3JtRWxlbWVudCIsImhhbmRsZUVzY0tleSIsImhhbmRsZU91dHNpZGVDbGljayIsIm1vZGFsRWRpdFdpbmRvdyIsIm1vZGFsQWRkV2luZG93IiwibW9kYWxQcmV2aWV3V2luZG93IiwiZ2V0RWxlbWVudEJ5SWQiLCJhZGRQaWN0dXJlRm9ybSIsInBpY3R1cmVUaXRsZUlucHV0IiwibmV3UGljdHVyZSIsIm5hbWVPZlBsYWNlIiwicGljdHVyZUxpbmtJbnB1dCIsImxpbmtPZlBsYWNlIiwicmVuZGVyQ2FyZCIsInBob3RvR3JpZCIsImdlbmVyYXRlQ2FyZCIsInVzZXJDYXJkIiwiaW1hZ2VQb3B1cCIsInNldEV2ZW50TGlzdGVuZXJzIiwib3BlbiIsImVkaXRGb3JtVmFsaWRhdG9yIiwiY2FyZEZvcm1WYWxpZGF0b3IiLCJlbmFibGVWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==